{% extends "_base.html" %}

{% block title %}
    {{ page_title  }}
{% endblock %}

{% block content %}
    <section id="p_timeline">
        <div class="p_container pui">
            <div class="box">
                <div class="text">
                    <p>그룹 생성</p>
                    <form id="form_post" method="post" action="">{% csrf_token %}
                        <pre>
                        <label class="text">그룹이름</label><input type="text" name="group_name">
                        <label class="text">설명</label><textarea class="postFormText" name="description" placeholder="멤버들에게 소식을 전하세요."></textarea>
                        <label class="text">프로젝트?</label><input type="checkbox" name="is_project">
                        <label class="text">공개범위</label>
                        <select name="open_scope">
                            <option value="open">모두에게 공개</option>
                            <option value="semi-open">멤버들에게만 공개</option>
                            <option value="close">비공개</option>
                        </select>
                        <label class="text">멤버추가</label><input type="text" id="group_search_friend"></pre>
                        <ul id="group_member_search_result"></ul>
                        <ul id="group_member_request_result"></ul>
                        <div class="text-center">
                            <div id="group_response" class="tooltip-parent tooltip-hover">
                                <input class="btn tooltip-parent tooltip-hover" type="submit" name="group_submit" value="생성">
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>
{% endblock %}

{% block add_scripts %}
    <script type="text/javascript" src="{{ STATIC_URL }}js/group_create.js"></script>
    <script type="text/javascript">
        $('#group_search_friend').keyup(function() {
            if(!$(this).val())
                return false;
            var feedback_api = '/api/v1/user/search/?q='+$(this).val();
            $.ajax({
                url: feedback_api,
                type: "GET",
                dataType: "json",
                success: function(data) {
                    if(data.objects.length == 0) {
                         $('#group_member_search_result').html('');
                    }
                    for(var index in  data.objects){
                        $('#group_member_search_result').html('<li>'+data.objects[index].username+'</li>');
                    }
                }
            });
        });
    </script>
{% endblock %}